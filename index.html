<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ”„ ê¸€ë¡œë²Œ ê²½ì œ ìƒí™©íŒ (ì •ë°€ ë³µêµ¬)</title>
    <style>
        body { background-color: #121212; color: #e0e0e0; font-family: -apple-system, sans-serif; padding: 15px; margin: 0; }
        .header { text-align: center; font-size: 1.1rem; font-weight: bold; margin-bottom: 25px; color: #c5a059; border: 1px solid #444; border-radius: 8px; padding: 10px; }
        .category { margin-top: 25px; font-size: 0.95rem; color: #ffffff; font-weight: bold; }
        .hr-short { border: 0; border-top: 2px solid #c5a059; width: 30px; margin: 5px 0 10px 0; }
        .item-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 5px; border-bottom: 1px solid #222; }
        .label { font-size: 0.95rem; color: #bbbbbb; } 
        .val-container { text-align: right; }
        .value { font-size: 1rem; font-weight: 600; font-family: 'Roboto Mono', monospace; color: #ffffff; }
        .change { font-size: 0.75rem; margin-top: 2px; font-weight: bold; }
        .up { color: #ff4444; } .down { color: #4488ff; }
        .status-msg { text-align: center; font-size: 0.7rem; color: #555; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="header" onclick="location.reload()">ğŸ”„ ì‹¤ì‹œê°„ ê²½ì œ ìƒí™©íŒ</div>

    <div class="category">ì™¸í™˜/ì½”ì¸</div><hr class="hr-short">
    <div id="fx-section"></div>

    <div class="category">ì£¼ìš” ì¦ì‹œ/ê¸ˆë¦¬</div><hr class="hr-short">
    <div id="stock-section"></div>

    <div class="status-msg" id="status-msg">ë°ì´í„° ìˆ˜ì§‘ì„ ì‹œì‘í•©ë‹ˆë‹¤...</div>
    <div style="text-align:center; font-size:0.6rem; color:#333; margin-top:30px;">2026 Developed by S.K. Chun</div>

    <script>
        const API_KEY = "7142915ec1dc45caad56dfc9fcf07341";
        
        // ì§€ìˆ˜ëŠ” ë¬´ë£Œ APIì—ì„œ ë§‰íˆë¯€ë¡œ ETFë¡œ ëŒ€ì²´í•˜ì—¬ ë°°ìœ¨(factor) ì ìš©
        const fxItems = [
            { l: "ì›/ë‹¬ëŸ¬", s: "USD/KRW", factor: 1 },
            { l: "ì›/ì—”", s: "JPY/KRW", factor: 1 },
            { l: "ë¹„íŠ¸ì½”ì¸($)", s: "BTC/USD", factor: 1 }
        ];

        const stockItems = [
            { l: "S&P 500", s: "SPY", factor: 10 },    // SPY ê°€ê²© * 10 â‰’ S&P 500 ì§€ìˆ˜
            { l: "ë‚˜ìŠ¤ë‹¥ 100", s: "QQQ", factor: 1 },  // ë‚˜ìŠ¤ë‹¥ ì§€ìˆ˜ëŠ” QQQ ê°€ê²©ìœ¼ë¡œ ëŒ€ì²´ í‘œì‹œ
            { l: "KOSPI (ETF)", s: "EWY", factor: 35 }, // í•œêµ­ ì§€ìˆ˜ ETF ê¸°ë°˜ í™˜ì‚°
            { l: "ë¯¸ êµ­ì±„ 10ë…„", s: "TNX", factor: 0.1 } 
        ];

        function initLayout() {
            document.getElementById('fx-section').innerHTML = fxItems.map(item => createRow(item)).join('');
            document.getElementById('stock-section').innerHTML = stockItems.map(item => createRow(item)).join('');
        }

        function createRow(item) {
            return `
                <div class="item-row">
                    <span class="label">${item.l}</span>
                    <div class="val-container">
                        <div class="value" id="val-${item.s}">--</div>
                        <div class="change" id="chg-${item.s}"></div>
                    </div>
                </div>`;
        }

        async function updateData() {
            const allItems = [...fxItems, ...stockItems];
            for (let i = 0; i < allItems.length; i++) {
                const item = allItems[i];
                try {
                    const res = await fetch(`https://api.twelvedata.com/quote?symbol=${item.s}&apikey=${API_KEY}`);
                    const d = await res.json();
                    
                    if (d.close) {
                        const cur = parseFloat(d.close) * item.factor;
                        const prev = parseFloat(d.previous_close) * item.factor;
                        const diff = cur - prev;
                        const pct = (diff / prev * 100).toFixed(2);
                        
                        // ê°’ í‘œì‹œ
                        const valEl = document.getElementById(`val-${item.s}`);
                        valEl.innerText = (item.s === "JPY/KRW") ? cur.toFixed(3) : cur.toLocaleString(undefined, {minimumFractionDigits: 2});

                        // ë“±ë½ í‘œì‹œ (ì§ì ‘ ê³„ì‚°)
                        const chgEl = document.getElementById(`chg-${item.s}`);
                        const sign = diff > 0 ? "â–²" : (diff < 0 ? "â–¼" : "");
                        const cls = diff > 0 ? "up" : (diff < 0 ? "down" : "");
                        
                        chgEl.className = "change " + cls;
                        chgEl.innerText = `${sign} ${Math.abs(diff).toFixed(2)} (${pct}%)`;
                    }
                } catch (e) { console.error(item.l + " ì‹¤íŒ¨"); }
                
                document.getElementById('status-msg').innerText = `ì—…ë°ì´íŠ¸ ì¤‘ (${i+1}/${allItems.length})...`;
                // API í•œë„ ë°©ì§€ë¥¼ ìœ„í•´ ìš”ì²­ ê°„ê²© ìœ ì§€ (8ì´ˆ)
                await new Promise(r => setTimeout(r, 8500));
            }
            document.getElementById('status-msg').innerText = "ì—…ë°ì´íŠ¸ ì™„ë£Œ: " + new Date().toLocaleTimeString();
        }

        window.onload = () => {
            initLayout();
            updateData();
        };
    </script>
</body>
</html>
