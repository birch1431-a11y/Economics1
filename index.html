<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ”„ ê¸€ë¡œë²Œ ê²½ì œ ìƒí™©íŒ (API ì§ê²°)</title>
    <style>
        body { background-color: #121212; color: #e0e0e0; font-family: -apple-system, sans-serif; padding: 15px; margin: 0; }
        .header { text-align: center; font-size: 1.1rem; font-weight: bold; margin-bottom: 25px; color: #c5a059; cursor: pointer; padding: 10px; border: 1px solid #444; border-radius: 8px; }
        .hr-short { border: 0; border-top: 2px solid #c5a059; width: 30px; margin: 5px 0 10px 0; }
        .category { margin-top: 25px; font-size: 0.95rem; color: #ffffff; font-weight: bold; }
        .item-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 5px; border-bottom: 1px solid #222; }
        .label { font-size: 0.95rem; color: #bbbbbb; font-weight: 400; } 
        .val-container { text-align: right; }
        .value { font-size: 1rem; font-weight: 600; font-family: 'Roboto Mono', monospace; color: #ffffff; display: block; }
        .change { font-size: 0.75rem; font-weight: 400; margin-top: 2px; }
        .up { color: #ff4444; } .down { color: #4488ff; }
        .status-danger { color: #ff4444 !important; } 
        .status-warning { color: #ffbb33 !important; } 
        .status-safe { color: #00ff88 !important; }
        .footer-copy { text-align: center; font-size: 0.7rem; color: #555; margin: 40px 0 10px 0; border-top: 1px solid #222; padding-top: 20px; letter-spacing: 0.5px; }
    </style>
</head>
<body>
    <div class="header" onclick="location.reload()">ğŸ”„ ê¸€ë¡œë²Œ ê²½ì œ ìƒí™©íŒ</div>

    <div class="category">ì™¸í™˜</div><hr class="hr-short">
    <div class="item-row"><span class="label">ë‹¬ëŸ¬ì§€ìˆ˜</span><div class="val-container"><span class="value" id="DXY">--</span><div class="change" id="DXY-c">--</div></div></div>
    <div class="item-row"><span class="label">ì›/ë‹¬ëŸ¬</span><div class="val-container"><span class="value" id="USD/KRW">--</span><div class="change" id="USD/KRW-c">--</div></div></div>
    <div class="item-row"><span class="label">ì›/ì—”</span><div class="val-container"><span class="value" id="JPY/KRW">--</span><div class="change" id="JPY/KRW-c">--</div></div></div>
    <div class="item-row"><span class="label">ì›/ìœ ë¡œ</span><div class="val-container"><span class="value" id="EUR/KRW">--</span><div class="change" id="EUR/KRW-c">--</div></div></div>
    <div class="item-row"><span class="label">ì›/ìœ„ì•ˆ</span><div class="val-container"><span class="value" id="CNY/KRW">--</span><div class="change" id="CNY/KRW-c">--</div></div></div>

    <div class="category">ì£¼ìš” ì¦ì‹œì§€í‘œ</div><hr class="hr-short">
    <div class="item-row"><span class="label">ë¯¸ ì¦ì‹œ ì‹œì´($T)</span><div class="val-container"><span class="value" id="US_MCAP">--</span><div class="change" id="US_MCAP-c">--</div></div></div>
    <div class="item-row"><span class="label">S&P 500</span><div class="val-container"><span class="value" id="SP500">--</span><div class="change" id="SP500-c">--</div></div></div>
    <div class="item-row"><span class="label">NASDAQ</span><div class="val-container"><span class="value" id="NASDAQ">--</span><div class="change" id="NASDAQ-c">--</div></div></div>
    <div class="item-row"><span class="label">DOW</span><div class="val-container"><span class="value" id="DOW">--</span><div class="change" id="DOW-c">--</div></div></div>
    <div class="item-row"><span class="label">í•œ ì¦ì‹œ ì‹œì´(ì¡°â‚©)</span><div class="val-container"><span class="value" id="KR_MCAP">--</span><div class="change" id="KR_MCAP-c">--</div></div></div>
    <div class="item-row"><span class="label">KOSPI</span><div class="val-container"><span class="value" id="KOSPI">--</span><div class="change" id="KOSPI-c">--</div></div></div>
    <div class="item-row"><span class="label">ë‹¬ëŸ¬í™˜ì‚° KOSPI</span><div class="val-container"><span class="value" id="KOSPI_USD">--</span><div class="change" id="KOSPI_USD-c">--</div></div></div>
    <div class="item-row"><span class="label">KOSDAQ</span><div class="val-container"><span class="value" id="KOSDAQ">--</span><div class="change" id="KOSDAQ-c">--</div></div></div>

    <div class="category">ë¯¸êµ­ êµ­ì±„ ê¸ˆë¦¬</div><hr class="hr-short">
    <div class="item-row"><span class="label">10Y Yield</span><div class="val-container"><span class="value" id="US10Y">--</span><div class="change" id="US10Y-c">--</div></div></div>
    <div class="item-row"><span class="label">2Y Yield</span><div class="val-container"><span class="value" id="US2Y">--</span><div class="change" id="US2Y-c">--</div></div></div>

    <div class="category">ì›ìì¬/ì½”ì¸</div><hr class="hr-short">
    <div class="item-row"><span class="label">GOLD</span><div class="val-container"><span class="value" id="GOLD">--</span><div class="change" id="GOLD-c">--</div></div></div>
    <div class="item-row"><span class="label">BTC($)</span><div class="val-container"><span class="value" id="BTC">--</span><div class="change" id="BTC-c">--</div></div></div>
    <div class="item-row"><span class="label">XRP($)</span><div class="val-container"><span class="value" id="XRP">--</span><div class="change" id="XRP-c">--</div></div></div>

    <div class="footer-copy">2026 Developed by S.K. Chun</div>
    <div id="status-msg" style="text-align:center; font-size:0.7rem; color:#555; margin-bottom:30px;">API ì—°ê²° ì¤‘...</div>

    <script>
        const API_KEY = "7142915ec1dc45caad56dfc9fcf07341";
        const BASE_US_MCAP = 62.5; 
        const BASE_KR_MCAP = 4660; 
        let live = { k:0, kp:0, u:0, up:0, y10:0, y2:0 };

        async function getAPI(symbol, id) {
            try {
                const res = await fetch(`https://api.twelvedata.com/quote?symbol=${symbol}&apikey=${API_KEY}`);
                const d = await res.json();
                if(d.close) {
                    const cur = parseFloat(d.close);
                    const prev = parseFloat(d.previous_close);
                    updateView(id, cur, prev);
                }
            } catch (e) { console.error(id + " ì‹¤íŒ¨"); }
        }

        function updateView(id, cur, prev) {
            const el = document.getElementById(id);
            if (!el) return;
            
            let val = cur;
            // ì§€ìˆ˜ ë³´ì • (ETFë¥¼ ì§€ìˆ˜ì²˜ëŸ¼ ë³´ì´ê²Œ ê³±ì…ˆ)
            if(id === "SP500") val = cur * 10;
            if(id === "NASDAQ") val = cur * 40;
            if(id === "DOW") val = cur * 100;

            el.innerText = (id === "XRP" || id === "SILVER") ? val.toFixed(3) : 
                           (id.includes("US") && id.includes("Y")) ? val.toFixed(2) + "%" :
                           val.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2});
            
            const diff = (cur - prev) * (id === "SP500" ? 10 : id === "NASDAQ" ? 40 : id === "DOW" ? 100 : 1);
            const pct = ((cur - prev) / prev * 100).toFixed(2);
            const cEl = document.getElementById(id + "-c");
            if(cEl) {
                cEl.innerHTML = `<span class="${diff>0?'up':'down'}">${diff>0?'â–²':'â–¼'} ${Math.abs(diff).toLocaleString(undefined,{minimumFractionDigits:2})} (${pct}%)</span>`;
            }

            // íŠ¹ìˆ˜ ì—°ì‚°
            if(id === "KOSPI") { live.k=cur; live.kp=prev; updateKrMcap(cur, prev); }
            if(id === "USD/KRW") { live.u=cur; live.up=prev; }
            if(id === "US_MCAP_BASE") updateUsMcap(cur, prev);
            updateKospiUsd();
        }

        function updateUsMcap(c, p) {
            const m = (BASE_US_MCAP * (c/p)).toFixed(2);
            document.getElementById("US_MCAP").innerText = m;
        }
        function updateKrMcap(c, p) {
            const m = Math.floor(BASE_KR_MCAP * (c/p));
            document.getElementById("KR_MCAP").innerText = m.toLocaleString();
        }
        function updateKospiUsd() {
            if(live.k && live.u) {
                const c = (live.k/live.u).toFixed(2);
                document.getElementById("KOSPI_USD").innerText = c;
            }
        }

        async function init() {
            // [ì¤‘ìš”] ë¬´ë£Œ API ì œí•œ ìš°íšŒë¥¼ ìœ„í•´ ETF ì‹¬ë³¼ ì‚¬ìš©
            const jobs = [
                ["DXY", "DXY"], ["USD/KRW", "USD/KRW"], ["JPY/KRW", "JPY/KRW"], ["EUR/KRW", "EUR/KRW"],
                ["SPY", "SP500"], ["QQQ", "NASDAQ"], ["DIA", "DOW"], // ì§€ìˆ˜ ëŒ€ì‹  ETF
                ["KOSPI", "KOSPI"], ["KOSDAQ", "KOSDAQ"], ["VTI", "US_MCAP_BASE"],
                ["TMUBMUSD10Y", "US10Y"], ["TMUBMUSD02Y", "US2Y"],
                ["XAU/USD", "GOLD"], ["BTC/USD", "BTC"], ["XRP/USD", "XRP"]
            ];

            for(let i=0; i<jobs.length; i++) {
                getAPI(jobs[i][0], jobs[i][1]);
                await new Promise(r => setTimeout(r, 8000)); // 1ë¶„ë‹¹ 8ê°œ ì œí•œ ì¤€ìˆ˜ (ì•„ì£¼ ì²œì²œíˆ)
                document.getElementById('status-msg').innerText = `ìˆ˜ì‹  ì¤‘ (${Math.round((i/jobs.length)*100)}%)...`;
            }
            document.getElementById('status-msg').innerText = "ì—…ë°ì´íŠ¸ ì™„ë£Œ: " + new Date().toLocaleTimeString();
        }
        window.onload = init;
    </script>
</body>
</html>
