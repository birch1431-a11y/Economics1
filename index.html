<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ”„ ê¸€ë¡œë²Œ ê²½ì œ ìƒí™©íŒ</title>
    <style>
        body { background-color: #121212; color: #e0e0e0; font-family: -apple-system, sans-serif; padding: 15px; margin: 0; }
        .header { text-align: center; font-size: 1.1rem; font-weight: bold; margin-bottom: 25px; color: #c5a059; cursor: pointer; padding: 10px; border: 1px solid #444; border-radius: 8px; }
        .hr-short { border: 0; border-top: 2px solid #c5a059; width: 30px; margin: 5px 0 10px 0; }
        .category { margin-top: 25px; font-size: 0.95rem; color: #ffffff; font-weight: bold; }
        .item-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 5px; border-bottom: 1px solid #222; }
        .label { font-size: 0.95rem; color: #bbbbbb; font-weight: 400; } 
        .val-container { text-align: right; }
        .value { font-size: 1rem; font-weight: 600; font-family: 'Roboto Mono', monospace; color: #ffffff; display: block; }
        .change { font-size: 0.75rem; font-weight: 400; margin-top: 2px; }
        .up { color: #ff4444; } .down { color: #4488ff; }
        /* VIX ë° ì§€í‘œ ìƒíƒœ ìƒ‰ìƒ */
        .status-danger { color: #ff4444 !important; } 
        .status-warning { color: #ffbb33 !important; } 
        .status-safe { color: #00ff88 !important; }
        .footer-copy { text-align: center; font-size: 0.7rem; color: #555; margin: 40px 0 10px 0; border-top: 1px solid #222; padding-top: 20px; letter-spacing: 0.5px; }
    </style>
</head>
<body>
    <div class="header" onclick="location.reload()">ğŸ”„ ê¸€ë¡œë²Œ ê²½ì œ ìƒí™©íŒ</div>

    <div class="category">ì™¸í™˜</div><hr class="hr-short">
    <div class="item-row"><span class="label">ë‹¬ëŸ¬ì§€ìˆ˜</span><div class="val-container"><span class="value" id="DXY">--</span><div class="change" id="DXY-c">--</div></div></div>
    <div class="item-row"><span class="label">ì›/ë‹¬ëŸ¬</span><div class="val-container"><span class="value" id="USD/KRW">--</span><div class="change" id="USD/KRW-c">--</div></div></div>
    <div class="item-row"><span class="label">ì›/ì—”</span><div class="val-container"><span class="value" id="JPY/KRW">--</span><div class="change" id="JPY/KRW-c">--</div></div></div>
    <div class="item-row"><span class="label">ì›/ìœ ë¡œ</span><div class="val-container"><span class="value" id="EUR/KRW">--</span><div class="change" id="EUR/KRW-c">--</div></div></div>
    <div class="item-row"><span class="label">ì›/ìœ„ì•ˆ</span><div class="val-container"><span class="value" id="CNY/KRW">--</span><div class="change" id="CNY/KRW-c">--</div></div></div>

    <div class="category">ì£¼ìš” ì¦ì‹œì§€í‘œ</div><hr class="hr-short">
    <div class="item-row"><span class="label">ë¯¸ ì¦ì‹œ ì‹œì´($T)</span><div class="val-container"><span class="value" id="US_MCAP">--</span><div class="change" id="US_MCAP-c">--</div></div></div>
    <div class="item-row"><span class="label">S&P 500</span><div class="val-container"><span class="value" id="SP500">--</span><div class="change" id="SP500-c">--</div></div></div>
    <div class="item-row"><span class="label">NASDAQ</span><div class="val-container"><span class="value" id="NASDAQ">--</span><div class="change" id="NASDAQ-c">--</div></div></div>
    <div class="item-row"><span class="label">DOW</span><div class="val-container"><span class="value" id="DOW">--</span><div class="change" id="DOW-c">--</div></div></div>
    <div class="item-row"><span class="label">í•œ ì¦ì‹œ ì‹œì´(ì¡°â‚©)</span><div class="val-container"><span class="value" id="KR_MCAP">--</span><div class="change" id="KR_MCAP-c">--</div></div></div>
    <div class="item-row"><span class="label">KOSPI</span><div class="val-container"><span class="value" id="KOSPI">--</span><div class="change" id="KOSPI-c">--</div></div></div>
    <div class="item-row"><span class="label">ë‹¬ëŸ¬í™˜ì‚° KOSPI</span><div class="val-container"><span class="value" id="KOSPI_USD">--</span><div class="change" id="KOSPI_USD-c">--</div></div></div>
    <div class="item-row"><span class="label">KOSDAQ</span><div class="val-container"><span class="value" id="KOSDAQ">--</span><div class="change" id="KOSDAQ-c">--</div></div></div>

    <div class="category">ë¯¸êµ­ êµ­ì±„ ê¸ˆë¦¬</div><hr class="hr-short">
    <div class="item-row"><span class="label">30Y Yield</span><div class="val-container"><span class="value" id="US30Y">--</span><div class="change" id="US30Y-c">--</div></div></div>
    <div class="item-row"><span class="label">10Y Yield</span><div class="val-container"><span class="value" id="US10Y">--</span><div class="change" id="US10Y-c">--</div></div></div>
    <div class="item-row"><span class="label">2Y Yield</span><div class="val-container"><span class="value" id="US2Y">--</span><div class="change" id="US2Y-c">--</div></div></div>

    <div class="category">ì›ìì¬</div><hr class="hr-short">
    <div class="item-row"><span class="label">GOLD($/oz)</span><div class="val-container"><span class="value" id="GOLD">--</span><div class="change" id="GOLD-c">--</div></div></div>
    <div class="item-row"><span class="label">SILVER($/oz)</span><div class="val-container"><span class="value" id="SILVER">--</span><div class="change" id="SILVER-c">--</div></div></div>
    <div class="item-row"><span class="label">êµ¬ë¦¬($/lb)</span><div class="val-container"><span class="value" id="COPPER">--</span><div class="change" id="COPPER-c">--</div></div></div>
    <div class="item-row"><span class="label">PLATINUM($/oz)</span><div class="val-container"><span class="value" id="PLATINUM">--</span><div class="change" id="PLATINUM-c">--</div></div></div>
    <div class="item-row"><span class="label">WTIìœ ($/bbl)</span><div class="val-container"><span class="value" id="WTI">--</span><div class="change" id="WTI-c">--</div></div></div>

    <div class="category">ê°€ìƒìì‚°</div><hr class="hr-short">
    <div class="item-row"><span class="label">BTC($)</span><div class="val-container"><span class="value" id="BTC">--</span><div class="change" id="BTC-c">--</div></div></div>
    <div class="item-row"><span class="label">ETH($)</span><div class="val-container"><span class="value" id="ETH">--</span><div class="change" id="ETH-c">--</div></div></div>
    <div class="item-row"><span class="label">XRP($)</span><div class="val-container"><span class="value" id="XRP">--</span><div class="change" id="XRP-c">--</div></div></div>

    <div class="category">ì‹œì¥ ì‹¬ë¦¬ ë° ë°¸ë¥˜ì—ì´ì…˜</div><hr class="hr-short">
    <div class="item-row"><span class="label">VIX ì§€ìˆ˜</span><div class="val-container"><span class="value" id="VIX">--</span><div class="change" id="VIX-c">--</div></div></div>
    <div class="item-row"><span class="label">ì¥ë‹¨ê¸° ê¸ˆë¦¬ì°¨</span><div class="val-container"><span class="value" id="SPREAD">--</span><div class="change" id="SPREAD-c">--</div></div></div>
    <div class="item-row"><span class="label">ë²„í• ì§€ìˆ˜</span><span class="value" id="BUFFETT">--</span></div>
    <div class="item-row"><span class="label">ì‰´ëŸ¬ PER</span><span class="value" id="SHILLER">--</span></div>

    <div class="footer-copy">2026 Developed by <span style="color: #777; font-weight: 500;">S.K. Chun</span></div>
    <div id="status-msg" style="text-align:center; font-size:0.7rem; color:#555; margin-bottom:30px;">ë°ì´í„° ì—°ê²° ì¤‘...</div>

    <script>
        const MY_API_KEY = "7142915ec1dc45caad56dfc9fcf07341";
        const BASE_US_MCAP = 55.2; 
        const BASE_KR_MCAP = 2450; 
        let live = { k:0, kp:0, u:0, up:0, y10:0, y10p:0, y2:0, y2p:0 };

        async function fetchData(url) {
            const proxy = `https://corsproxy.io/?${encodeURIComponent(url)}`;
            try {
                const res = await fetch(proxy);
                return await res.json();
            } catch (e) { return null; }
        }

        function formatChange(c, p, id) {
            const diff = c - p, pct = (diff/p*100).toFixed(2);
            const sign = diff > 0 ? "â–²" : diff < 0 ? "â–¼" : "";
            const cls = diff > 0 ? "up" : diff < 0 ? "down" : "";
            const cEl = document.getElementById(id + "-c");
            if(cEl) cEl.innerHTML = `<span class="${cls}">${sign} ${Math.abs(diff).toLocaleString(undefined, {minimumFractionDigits:2})} (${pct}%)</span>`;
        }

        async function getYahoo(ticker, id) {
            try {
                const data = await fetchData(`https://query1.finance.yahoo.com/v8/finance/chart/${ticker}?interval=1m&range=1d`);
                if (data && data.chart && data.chart.result) {
                    const meta = data.chart.result[0].meta;
                    const cur = meta.regularMarketPrice;
                    const prev = meta.previousClose;
                    const el = document.getElementById(id);

                    if (el) {
                        if (ticker === "^IXIC" || ticker === "^DJI") el.innerText = cur.toLocaleString(undefined, {minimumFractionDigits:2});
                        else if (id.includes("US") && !id.includes("MCAP")) el.innerText = cur.toFixed(3) + "%";
                        else if (cur > 100) el.innerText = cur.toLocaleString(undefined, {maximumFractionDigits:2});
                        else el.innerText = cur.toFixed(2);
                        
                        formatChange(cur, prev, id);

                        // VIX ì „ìš© ìƒ‰ìƒ ë¡œì§
                        if (id === "VIX") {
                            if (cur >= 30) el.className = "value status-danger";
                            else if (cur >= 20) el.className = "value status-warning";
                            else el.className = "value status-safe";
                        }
                    }

                    if(id === "KOSPI") { live.k=cur; live.kp=prev; updateKrMcap(cur, prev); }
                    if(id === "US10Y") { live.y10=cur; live.y10p=prev; updateSpread(); }
                    if(id === "US2Y") { live.y2=cur; live.y2p=prev; updateSpread(); }
                    if(ticker === "VTI") updateUsMcap(cur, prev);
                    updateKospiUsd();
                }
            } catch (err) { console.error(id + " ë¡œë“œ ì‹¤íŒ¨"); }
        }

        function updateUsMcap(c, p) {
            const m = BASE_US_MCAP * (c/p);
            const el = document.getElementById("US_MCAP");
            if(el) {
                el.innerText = m.toFixed(2);
                formatChange(m, BASE_US_MCAP, "US_MCAP");
                const bft = (m/27.94*100).toFixed(1);
                const bEl = document.getElementById("BUFFETT");
                if(bEl) { 
                    bEl.innerText = bft + "%"; 
                    bEl.className = "value " + (bft>=150?"status-danger":bft>=120?"status-warning":"status-safe"); 
                }
            }
        }

        function updateKrMcap(c, p) {
            const m = BASE_KR_MCAP * (c/p);
            const el = document.getElementById("KR_MCAP");
            if(el) { el.innerText = Math.floor(m).toLocaleString(); formatChange(m, BASE_KR_MCAP, "KR_MCAP"); }
        }

        function updateKospiUsd() {
            if(live.k && live.u) {
                const c = live.k/live.u, p = live.kp/live.up;
                const el = document.getElementById("KOSPI_USD");
                if(el) { el.innerText = c.toFixed(2); formatChange(c, p, "KOSPI_USD"); }
            }
        }

        function updateSpread() {
            if(live.y10 && live.y2) {
                const s = live.y10-live.y2, sp = live.y10p-live.y2p;
                const el = document.getElementById("SPREAD");
                if(el) { 
                    el.innerText = s.toFixed(3) + "%p"; 
                    formatChange(s, sp, "SPREAD"); 
                    el.className = "value " + (s<0?"status-danger":"status-safe"); 
                }
            }
        }

        async function init() {
            // ì‹œì´ ê³„ì‚° ê¸°ì¤€ìš©
            await getYahoo("VTI", "VTI_HIDDEN");

            const jobs = [
                ["DX-Y.NYB","DXY"], ["^GSPC","SP500"], ["^IXIC","NASDAQ"], ["^DJI","DOW"],
                ["^KS11","KOSPI"], ["^KQ11","KOSDAQ"], ["^TYX","US30Y"], ["^TNX","US10Y"], ["^IRX","US2Y"],
                ["GC=F","GOLD"], ["SI=F","SILVER"], ["HG=F","COPPER"], ["PL=F","PLATINUM"], ["CL=F","WTI"],
                ["BTC-USD","BTC"], ["ETH-USD","ETH"], ["XRP-USD","XRP"], ["^VIX","VIX"]
            ];
            
            jobs.forEach(j => getYahoo(j[0], j[1]));

            const fx = ["USD/KRW","JPY/KRW","EUR/KRW","CNY/KRW"];
            for (const s of fx) {
                fetch(`https://api.twelvedata.com/quote?symbol=${s}&apikey=${MY_API_KEY}`)
                .then(r=>r.json()).then(d=>{
                    if(d && d.close){
                        const c=parseFloat(d.close), p=parseFloat(d.previous_close);
                        const el = document.getElementById(s);
                        if(el) {
                            el.innerText = c.toLocaleString(undefined,{minimumFractionDigits:2});
                            formatChange(c, p, s);
                            if(s==="USD/KRW"){ live.u=c; live.up=p; updateKospiUsd(); }
                        }
                    }
                }).catch(e => console.error(s + " í™˜ìœ¨ ë¡œë“œ ì‹¤íŒ¨"));
                await new Promise(r => setTimeout(r, 500));
            }

            fetchData("https://query1.finance.yahoo.com/v8/finance/chart/CAPE?interval=1d&range=1d").then(d=>{
                if(d && d.chart && d.chart.result) {
                    const v = d.chart.result[0].meta.regularMarketPrice;
                    const el = document.getElementById("SHILLER");
                    if(el) { 
                        el.innerText = v.toFixed(1); 
                        el.className = "value " + (v>=30?"status-danger":v>=20?"status-warning":"status-safe"); 
                    }
                }
            });
            setTimeout(()=>{ document.getElementById('status-msg').innerText = "ìµœì¢… ì—…ë°ì´íŠ¸: " + new Date().toLocaleTimeString(); }, 3000);
        }
        window.onload = init;
    </script>
</body>
</html>
